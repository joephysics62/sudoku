<!DOCTYPE html>
<html>
  <head>
    <style>
.thickGrid {
  stroke-width: 2px;
  fill: none;
  stroke: black;
}

.thinGrid {
  stroke-width: 1px;
  fill: none;
  stroke: black;
}
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.6/angular.min.js"></script>
    <script type="text/javascript">
var app = angular.module('Connect4App', []);

app.controller('AppCtrl', ['$scope', '$document', function($scope, $document) {
	$scope.cellSize = 50;
	$scope.numRows = 6;
	$scope.numCols = 7;
	
	$scope.range = function(min, max, step) {
	    step = step || 1;
	    var input = [];
	    for (var i = min; i <= max; i += step) {
	        input.push(i);
	    }
	    return input;
	};
	
	$scope.players = [{name: 'Mr. Red', color: 'red'}, {name: 'Mr. Yellow', color: 'yellow'}];
	
	$scope.startGame = function() {
		$scope.player = 0;
		$scope.pieces = [];
		$scope.colButtons = initColButtons();
	};
	
	function initColButtons() {
		var out = [];
		for (i = 0; i < $scope.numCols; i++) {
			out.push(true);
		}
		return out;
	};
	
	$scope.addToCol = function(colNum) {
		var newRow = 1 + Math.max(maxFor($scope.pieces, colNum));
		if (newRow > $scope.numRows) {
			return;
		}
        $scope.pieces.push({x: colNum, y: newRow, p: $scope.players[$scope.player]});
        var winner = findWinner($scope.pieces);
        if (winner) {
        	for (i = 0; i < $scope.numCols; i++) {
    			out[i] = false;
    		}
        }
        else {
          $scope.colButtons[colNum - 1] = newRow < $scope.numRows;
          $scope.player = ($scope.player + 1) % $scope.players.length;
        }
	};
	
	$scope.startGame();
	
	function findWinner(pieces) {
		if (pieces.length < 4) {
			return null;
		}
		return null;
	}
	
	function maxFor(arr, colNum) {
		var redYs = arr
            .filter(function(value) { return value.x == colNum})
            .map(function(value) { return value.y});
        return redYs.length > 0 ? Math.max.apply(null, redYs) : 0;
	}
	
}]);

    </script>
  </head>
  <body ng-app="Connect4App" ng-cloak>
    <div ng-controller="AppCtrl">
      <div style="width: {{ cellSize * numCols }}px;height: {{ cellSize * numRows }}px; margin-left: 10px; margin-top: 10px">
      <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
        <rect id="boundingRectangle"
              ng-attr-x="0" ng-attr-y="0" 
              ng-attr-width="{{cellSize * numCols}}" 
              ng-attr-height="{{cellSize * numRows}}" 
              class="thickGrid" />
        <path ng-repeat="r in range(1, numRows - 1, 1)"
              ng-attr-d="M 0 {{r * cellSize}} L {{cellSize * numCols}} {{r * cellSize}}"
              class="thinGrid" />
        <path ng-repeat="r in range(1, numCols - 1, 1)"
              ng-attr-d="M {{r * cellSize}} 0 L {{r * cellSize}} {{numRows * cellSize}}" 
              class="thinGrid" />
        <circle ng-repeat="piece in pieces"
                ng-attr-cx="{{(piece.x - 0.5) * cellSize}}" 
                ng-attr-cy="{{(numRows - piece.y + 0.5) * cellSize}}" 
                ng-attr-r="{{cellSize / 2.5}}" stroke="none" 
                fill="{{piece.p.color}}" />
      </svg>
      <button ng-repeat="r in range(1, numCols, 1)"
              ng-click="addToCol(r)"
              ng-disabled="!colButtons[r - 1]"
              style="width: {{ cellSize }}px">^</button>
      <p><span style="font-weight: bold; color: {{ players[player].color }}">{{ players[player].name }}</span> to play...</p>
      <p></p>
      <button ng-click="startGame">Restart</button>
      </div>
    </div>
  </body>
</html>